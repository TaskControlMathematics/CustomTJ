(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1027:function(e,t,o){var n=o(1550);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,o(31).default)("a92891a2",n,!1,{})},1028:function(e,t,o){var n=o(1552);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,o(31).default)("6a944822",n,!1,{})},1029:function(e,t,o){var n=o(1554);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,o(31).default)("0c1c1532",n,!1,{})},1030:function(e,t,o){var n=o(1556);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,o(31).default)("4e8f08d7",n,!1,{})},1549:function(e,t,o){"use strict";o(1027)},1550:function(e,t,o){(t=o(30)(!1)).push([e.i,".audio-tool-cover[data-v-2c910cec] {\n  width: 100%;\n  margin-bottom: 15px;\n  position: relative;\n  background-color: #fff;\n  color: #595959;\n  border-radius: 4px;\n  min-height: 100px;\n}\n.audio-tool-cover[data-v-2c910cec]:after {\n  content: '';\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  border: 2px dashed #ccc;\n  border-radius: 4px;\n}\n.audio-tool-cover[data-v-2c910cec] input[type=\"file\"] {\n  width: 0;\n  height: 0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  visibility: hidden;\n}\n.audio-tool-cover[data-v-2c910cec] label {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n  z-index: 1;\n  cursor: pointer;\n}\n.audio-tool-cover[data-v-2c910cec]:hover {\n  color: #000;\n}\n.audio-tool-cover--empty .audio-tool-cover__image[data-v-2c910cec] {\n  display: none;\n}\n.audio-tool-cover--loading[data-v-2c910cec] {\n  pointer-events: none;\n}\n.audio-tool-cover--loading[data-v-2c910cec]:before {\n  content: '';\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n  position: absolute;\n  width: 30px;\n  height: 30px;\n  border-radius: 50%;\n  border: 2px solid #dedede;\n  border-top-color: #e5a040;\n  left: 50%;\n  top: 50%;\n  margin-top: -15px;\n  margin-left: -15px;\n  -webkit-animation: spinner-data-v-2c910cec 2s infinite linear;\n  animation: spinner-data-v-2c910cec 2s infinite linear;\n  z-index: 1;\n}\n.audio-tool-cover--loading .audio-tool-cover__image[data-v-2c910cec] {\n  -webkit-filter: grayscale(1);\n  filter: grayscale(1);\n}\n.audio-tool-cover__image[data-v-2c910cec] {\n  border-radius: 4px;\n  background-repeat: no-repeat;\n  background-size: cover;\n  background-color: #000;\n  overflow: hidden;\n}\n.audio-tool-cover__image img[data-v-2c910cec] {\n  display: block;\n  width: 100%;\n}\n.audio-tool-cover__label[data-v-2c910cec] {\n  position: absolute;\n  top: 50%;\n  left: 0;\n  -webkit-transform: translateY(-50%);\n  transform: translateY(-50%);\n  width: 100%;\n  text-align: center;\n}\n.audio-tool-cover__label[data-v-2c910cec] .icon {\n  vertical-align: middle;\n  margin-right: 0.4em;\n  margin-top: -2px;\n}\n.audio-tool-cover__remove[data-v-2c910cec] {\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 15px;\n  color: #fff;\n  cursor: pointer;\n  opacity: 0.8;\n  z-index: 2;\n}\n.audio-tool-cover__remove[data-v-2c910cec] svg {\n  fill: currentColor;\n}\n.audio-tool-cover__remove[data-v-2c910cec]:hover {\n  opacity: 1;\n}\n@-moz-keyframes spinner-data-v-2c910cec {\n100% {\n    transform: rotate(360deg);\n}\n}\n@-webkit-keyframes spinner-data-v-2c910cec {\n100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n}\n}\n@-o-keyframes spinner-data-v-2c910cec {\n100% {\n    transform: rotate(360deg);\n}\n}\n@keyframes spinner-data-v-2c910cec {\n100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n}\n}\n",""]),e.exports=t},1551:function(e,t,o){"use strict";o(1028)},1552:function(e,t,o){(t=o(30)(!1)).push([e.i,".audio-tool-title[data-v-3743a30d] {\n  -ms-flex: 1;\n  flex: 1;\n  background: #fff;\n  border: 1px solid #e3e5e9;\n  padding: 10px 12px;\n  border-radius: 4px;\n  font-size: inherit;\n  line-height: 1.5em;\n  cursor: text;\n}\n@media (max-width: 859px) {\n.audio-tool-title[data-v-3743a30d] {\n    margin-bottom: 15px;\n}\n}\n.audio-tool-title[data-v-3743a30d]::-webkit-input-placeholder {\n  color: #bfbfbf;\n}\n.audio-tool-title[data-v-3743a30d]::-moz-placeholder {\n  color: #bfbfbf;\n  opacity: 1;\n}\n.audio-tool-title[data-v-3743a30d]:-ms-input-placeholder {\n  color: #bfbfbf;\n}\n.audio-tool-title[data-v-3743a30d]:focus::-webkit-input-placeholder {\n  color: rgba(191,191,191,0.4);\n}\n.audio-tool-title[data-v-3743a30d]:focus::-moz-placeholder {\n  color: rgba(191,191,191,0.4);\n  opacity: 1;\n}\n.audio-tool-title[data-v-3743a30d]:focus:-ms-input-placeholder {\n  color: rgba(191,191,191,0.4);\n}\n",""]),e.exports=t},1553:function(e,t,o){"use strict";o(1029)},1554:function(e,t,o){(t=o(30)(!1)).push([e.i,'.audio-tool-uploader[data-v-6f90c26e] {\n  width: 40%;\n  margin-left: 15px;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n  align-items: center;\n  padding: 10px 25px;\n  border-radius: 4px;\n  background-color: #fff;\n  border: 1px solid rgba(0,0,0,0.15);\n  cursor: pointer;\n  -webkit-box-shadow: 0 2px 1px rgba(0,0,0,0.05);\n  box-shadow: 0 2px 1px rgba(0,0,0,0.05);\n  line-height: 1.5em;\n  position: relative;\n}\n@media (max-width: 859px) {\n.audio-tool-uploader[data-v-6f90c26e] {\n    width: 100%;\n    margin-left: 0;\n}\n}\n.audio-tool-uploader span[data-v-6f90c26e] {\n  width: 100%;\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  pointer-events: none;\n}\n.audio-tool-uploader[data-v-6f90c26e] input[type="file"] {\n  width: 0;\n  height: 0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  visibility: hidden;\n}\n.audio-tool-uploader[data-v-6f90c26e] label {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n  z-index: 1;\n  cursor: pointer;\n}\n.audio-tool-uploader[data-v-6f90c26e]:hover {\n  border-color: rgba(0,0,0,0.2);\n}\n.audio-tool-uploader--selected[data-v-6f90c26e] {\n  border: 0;\n  -webkit-box-shadow: none;\n  box-shadow: none;\n  color: #4683d9;\n  background-color: #edf3fb;\n}\n.audio-tool-uploader--selected[data-v-6f90c26e]:hover {\n  background-color: rgba(227,236,249,1);\n}\n.audio-tool-uploader--loading[data-v-6f90c26e] {\n  pointer-events: none;\n  background-image: repeating-linear-gradient(-45deg, transparent, transparent 10px, rgba(255,255,255,0.2) 10px, rgba(255,255,255,0.2) 20px);\n  background-size: 56px 56px;\n  -webkit-animation: loading 0.5s infinite linear;\n  animation: loading 0.5s infinite linear;\n}\n',""]),e.exports=t},1555:function(e,t,o){"use strict";o(1030)},1556:function(e,t,o){(t=o(30)(!1)).push([e.i,".audio-tool[data-v-588d11c2] {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-wrap: wrap;\n  flex-wrap: wrap;\n  padding: 15px 0;\n}\n",""]),e.exports=t},1640:function(e,t,o){"use strict";o.r(t),o.d(t,"AudioMaker",(function(){return T}));var n=o(35),a=o.n(n),i=o(42);var r=o(794),d=o(6),s=o(5),l=o(1);a.a.use(i.a);const c={HAS_COVER:e=>!!e.image&&(Object.keys(e.image).length>0&&e.image.data&&e.image.data.uuid),HAS_AUDIO:e=>!!e.audio&&(Object.keys(e.audio).length>0&&e.audio.data&&e.audio.data.uuid),IS_LOADING:e=>e.isLoading},u={REMOVE_COVER(e){e.image={}},SET_COVER(e,t){e.image=t},SET_AUDIO(e,t){e.audio=t},SET_IS_LOADING(e,{type:t,value:o}){a.a.set(e.isLoading,t,o)},SET_HASH(e,t){e.hash=t}},p={UPLOAD_AUDIO:({commit:e},{file:t})=>new Promise(o=>{e("SET_IS_LOADING",{type:"audio",value:!0}),d.uploadFiles([t],t=>{if(t&&t.length&&"error"!==t[0].type)e("SET_AUDIO",t[0]),o(t);else{const e=t&&t.length&&t[0].data&&t[0].data.error_text?t[0].data.error_text:Object(l.c)("Audio uploading failed");s.error(e)}e("SET_IS_LOADING",{type:"audio",value:!1})},!1,!0)}),UPLOAD_COVER:({commit:e},{file:t})=>new Promise(o=>{e("SET_IS_LOADING",{type:"cover",value:!0}),d.uploadFiles([t],t=>{t&&t.length?(e("SET_COVER",t[0]),o(t)):s.error(Object(l.c)("Cover uploading failed")),e("SET_IS_LOADING",{type:"cover",value:!1})})}),GET_COVER_PREVIEW:({dispatch:e},{file:t})=>new Promise((o,n)=>{const a=new FileReader;a.readAsDataURL(t),a.onload=t=>{const n=t.target.result;e("LOAD_IMAGE_SRC",{src:n}).then(e=>{o(e)})},a.onerror=e=>{n(e)}}),LOAD_IMAGE_SRC:(e,{src:t})=>new Promise((e,o)=>{const n=new Image;n.onload=()=>{e(n)},n.onerror=e=>{o(e)},n.src=t}),GENERATE_HASH({commit:e}){Object(r.a)().then(t=>{e("SET_HASH",t)})}};var h=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"audio-tool"},[o("audio-cover",{attrs:{image:e.$store.state.image},on:{remove:e.removeCover,upload:e.uploadCover}}),e._v(" "),o("audio-title",{attrs:{autofocus:!e.hasAudio},model:{value:e.$store.state.title,callback:function(t){e.$set(e.$store.state,"title",t)},expression:"$store.state.title"}}),e._v(" "),o("audio-uploader",{attrs:{audio:e.$store.state.audio},on:{upload:e.uploadAudio}})],1)};h._withStripped=!0;var v=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:{"audio-tool-cover":!0,"audio-tool-cover--empty":!e.hasCover&&!e.isEnabledBase64Preview,"audio-tool-cover--loading":e.isLoading}},[o("div",{staticClass:"audio-tool-cover__image",style:e.style}),e._v(" "),o("input",{attrs:{id:e.id,type:"file",accept:"image/png, image/jpeg"},on:{change:e.upload}}),e._v(" "),o("label",{attrs:{for:e.id}}),e._v(" "),e.hasCover?o("div",{staticClass:"audio-tool-cover__remove",on:{click:e.remove}},[o("icon",{attrs:{name:"writing-trash",width:"14",height:"15"}})],1):e._e(),e._v(" "),e.hasCover||e.isEnabledBase64Preview?e._e():o("div",{staticClass:"audio-tool-cover__label"},[o("icon",{attrs:{name:"ui_photo",width:"22",height:"21"}}),e._v(" "),o("translate",[e._v("\n      Upload cover\n    ")])],1)])};v._withStripped=!0;var g=o(26);var f={name:"audio-cover",components:{Icon:g.a},props:{image:{type:Object,required:!0}},data(){return{base64Preview:null,id:"audio-tool-cover"+this.$root.getBlockId()}},computed:{isLoading(){return this.$store.getters.IS_LOADING.cover},hasCover(){return this.$store.getters.HAS_COVER},isEnabledBase64Preview(){return this.base64Preview&&this.isLoading},color(){return this.image&&this.image.data&&this.image.data.color?this.image.data.color:"000"},url(){return this.image&&this.image.data&&this.image.data.uuid?"https://leonardo.osnova.io/"+this.image.data.uuid+"/-/preview/1600x950/-/progressive/yes/-/format/jpeg/":null},style(){return this.isEnabledBase64Preview?{"padding-bottom":this.base64Preview.height/this.base64Preview.width*100+"%","background-image":"url("+this.base64Preview.src+")"}:this.hasCover?{"padding-bottom":this.image.data.height/this.image.data.width*100+"%","background-color":"#"+this.color,"background-image":"url("+this.url+")"}:{}}},methods:{remove(){this.isLoading||this.$emit("remove")},upload(e){const t=e.target.files[0];t&&!this.isLoading&&(this.$store.dispatch("GET_COVER_PREVIEW",{file:t}).then(e=>{this.base64Preview=e}),this.$emit("upload",t))}}},m=(o(1549),o(10)),b=Object(m.a)(f,v,[],!1,null,"2c910cec",null);b.options.__file="src/Components/Editor/vue/audio/audio-cover.vue";var _=b.exports,w=function(){var e=this.$createElement;this._self._c;return this._m(0)};w._withStripped=!0;var x={name:"audio-title",directives:{focus:{inserted:(e,t,o)=>{!e.value&&o.context.autofocus&&e.focus()}}},props:{value:{type:String,required:!0},autofocus:{type:Boolean,default:!1}},data(){return{placeholder:this.$gettext("Audio title")}},methods:{input(e){this.$emit("input",e.target.value.trim())}}},E=(o(1551),Object(m.a)(x,w,[function(){var e=this.$createElement;return(this._self._c||e)("input",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"audio-tool-title",attrs:{type:"text",placeholder:this.placeholder},domProps:{value:this.value},on:{input:this.input}})}],!1,null,"3743a30d",null));E.options.__file="src/Components/Editor/vue/audio/audio-title.vue";var A=E.exports,y=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:{"audio-tool-uploader":!0,"audio-tool-uploader--selected":e.hasAudio||e.isLoading,"audio-tool-uploader--loading":e.isLoading}},[o("span",[e._v(e._s(e.hasAudio?e.filename:e.isLoading?e.tempName:e.uploadButtonLabel))]),e._v(" "),o("input",{attrs:{id:e.id,type:"file",accept:"audio/*"},on:{change:e.upload}}),e._v(" "),o("label",{attrs:{for:e.id,title:!!e.hasAudio&&e.url}})])};y._withStripped=!0;var k={name:"audio-uploader",props:{audio:{type:Object,required:!0}},data(){return{id:"audio-tool-uploader"+this.$root.getBlockId(),tempName:null,uploadButtonLabel:this.$gettext("Upload a file")}},computed:{isLoading(){return this.$store.getters.IS_LOADING.audio},hasAudio(){return this.$store.getters.HAS_AUDIO},filename(){return this.audio.data.filename},url(){return"https://leonardo.osnova.io/audio/"+this.audio.data.uuid}},methods:{upload(e){const t=e.target.files[0];t&&!this.isLoading?(this.tempName=t.name,this.$emit("upload",t)):e.target.value=""}}},O=(o(1553),Object(m.a)(k,y,[],!1,null,"6f90c26e",null));O.options.__file="src/Components/Editor/vue/audio/audio-uploader.vue";var S={name:"audio",components:{AudioCover:_,AudioTitle:A,AudioUploader:O.exports},computed:{hasAudio(){return this.$store.getters.HAS_AUDIO}},mounted(){this.$store.state.hash||this.$store.dispatch("GENERATE_HASH")},methods:{removeCover(){this.$store.commit("REMOVE_COVER"),this.$root.dispatchModifiedEvent()},async uploadCover(e){await this.$store.dispatch("UPLOAD_COVER",{file:e}),this.$root.dispatchModifiedEvent()},async uploadAudio(e){await this.$store.dispatch("UPLOAD_AUDIO",{file:e}),this.$root.dispatchModifiedEvent()}}},C=(o(1555),Object(m.a)(S,h,[],!1,null,"588d11c2",null));C.options.__file="src/Components/Editor/vue/audio/audio.vue";var $=C.exports,I=o(44),L=o.n(I),D=o(55);let P=null,R=null;class T{constructor({api:e,block:t}){P=e,R=t,this.form=null,this.container=null}makeContainer(){return this.container=document.createElement("div"),this.container}render(e){const t=function(e={}){return new i.a.Store({state:Object.assign({title:"",hash:"",image:{},audio:{},isLoading:{cover:!1,audio:!1}},e),getters:c,mutations:u,actions:p})}(e),o=P.getCurrentBlockId();return this.makeContainer(),a.a.use(L.a,{translations:D,defaultLanguage:window.__i18nLocale}),setTimeout(()=>{this.form=new a.a({el:this.container,store:t,methods:{getData(){return this.$store.state},getBlockId:()=>o,callEditorApi(e,t){Array.isArray(t)?P[e](...t):P[e](t)},dispatchModifiedEvent(){R.dispatchModifiedEvent()}},render:e=>e($)});const e=window.Air&&window.Air.get("module.hawk");e&&e.connectVue(a.a)},200),this.container}save(){return Promise.resolve().then(()=>this.form.getData())}}},794:function(e,t,o){"use strict";function n(){const e=new Uint32Array(1);return a(window.crypto.getRandomValues(e)[0]).then(e=>e.substring(0,16)+Date.now())}function a(e){const t=new TextEncoder("utf-8").encode(e);return window.crypto.subtle.digest("SHA-256",t).then(e=>function(e){const t=[],o=new DataView(e);for(let e=0;e<o.byteLength;e+=4){const n=o.getUint32(e).toString(16),a="00000000",i=(a+n).slice(-a.length);t.push(i)}return t.join("")}(e))}o.d(t,"a",(function(){return n})),o.d(t,"b",(function(){return a}))}}]);