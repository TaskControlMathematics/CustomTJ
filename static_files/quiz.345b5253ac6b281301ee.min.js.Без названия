(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{1022:function(t,e,n){var i=n(1540);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(31).default)("82dcc53c",i,!1,{})},1023:function(t,e,n){var i=n(1542);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(31).default)("76e44cd8",i,!1,{})},1024:function(t,e,n){var i=n(1544);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(31).default)("77d7a451",i,!1,{})},1025:function(t,e,n){var i=n(1546);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(31).default)("61492bcd",i,!1,{})},1539:function(t,e,n){"use strict";n(1022)},1540:function(t,e,n){(e=n(30)(!1)).push([t.i,".quiz-tool-input[data-v-c26e9582] {\n  -ms-flex: 1;\n  flex: 1;\n}\n",""]),t.exports=e},1541:function(t,e,n){"use strict";n(1023)},1542:function(t,e,n){(e=n(30)(!1)).push([t.i,".quiz-tool-item[data-v-3ed559fc] {\n  position: relative;\n  margin: 8px 0;\n}\n@media (max-width: 859px) {\n.quiz-tool-item[data-v-3ed559fc] {\n    margin-left: 20px;\n}\n}\n.quiz-tool-item[data-v-3ed559fc]:before {\n  counter-increment: quiz-option;\n  content: counter(quiz-option) '.';\n  position: absolute;\n  right: 100%;\n  padding-right: 5px;\n  line-height: 34px;\n  height: 34px;\n}\n.quiz-tool-item:hover .quiz-tool-item__remove[data-v-3ed559fc] {\n  opacity: 1;\n}\n.quiz-tool-item__remove[data-v-3ed559fc] {\n  cursor: pointer;\n  height: 100%;\n  padding: 0 12px;\n  position: absolute;\n  right: 0;\n  top: 0;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n  align-items: center;\n  -ms-flex-pack: center;\n  justify-content: center;\n  color: #bfbfbf;\n  opacity: 0;\n}\n.quiz-tool-item__remove[data-v-3ed559fc]:hover {\n  color: #e52e3a;\n}\n",""]),t.exports=e},1543:function(t,e,n){"use strict";n(1024)},1544:function(t,e,n){(e=n(30)(!1)).push([t.i,".form-text-input,\n.quiz-tool-input {\n  position: relative;\n  background: #fff;\n  border: 1px solid rgba(0,0,0,0.13);\n  border-top-color: rgba(0,0,0,0.29);\n  font-size: 15px;\n  padding: 7px 30px 7px 10px;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n  outline: none;\n  width: 100%;\n  resize: vertical;\n  line-height: 1.2em;\n}\n.form-text-input::-webkit-input-placeholder,\n.quiz-tool-input::-webkit-input-placeholder {\n  color: #595959;\n}\n.form-text-input::-moz-placeholder,\n.quiz-tool-input::-moz-placeholder {\n  color: #595959;\n  opacity: 1;\n}\n.form-text-input:-ms-input-placeholder,\n.quiz-tool-input:-ms-input-placeholder {\n  color: #595959;\n}\n.form-text-input--multiline,\n.quiz-tool-input--multiline {\n  line-height: 1.4em;\n}\n.form-text-input .icon,\n.quiz-tool-input .icon {\n  position: absolute;\n  right: 8px;\n  top: 8px;\n  color: #595959;\n}\n.form-text-input small,\n.quiz-tool-input small {\n  color: #595959;\n  font-size: 12px;\n  letter-spacing: 1px;\n  text-transform: uppercase;\n}\n.form-text-input--loading,\n.quiz-tool-input--loading {\n  background-image: repeating-linear-gradient(-45deg, transparent, transparent 4px, rgba(0,0,0,0.059) 4px, rgba(0,0,0,0.059) 8px) !important;\n  background-size: 34px 34px;\n  -webkit-animation: loading-bar 10s infinite linear;\n  animation: loading-bar 10s infinite linear;\n}\n.form-label {\n  display: block;\n  font-size: 15px;\n  margin-bottom: 13px;\n  font-weight: 500;\n}\n.form-label small {\n  font-size: 13px;\n  color: #595959;\n  margin-left: 10px;\n  font-weight: normal;\n}\n@media (max-width: 320px) {\n.form-label small {\n    display: block;\n    margin-top: 5px;\n    margin-left: 0;\n}\n}\n.form-picture {\n  width: 48px;\n  height: 48px;\n  min-width: 48px;\n  background-color: #fff;\n  position: relative;\n  cursor: pointer;\n  overflow: visible !important;\n}\n.form-picture .icon--ui_photo {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n  transform: translate(-50%, -50%);\n  z-index: 2;\n  visibility: hidden;\n}\n.form-picture::before {\n  content: '';\n  position: absolute;\n  right: 0;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  background: rgba(0,0,0,0.5);\n  z-index: 1;\n  visibility: hidden;\n}\n.form-picture--empty .icon--ui_photo {\n  visibility: visible;\n  opacity: 0.2;\n}\n.form-picture--empty img {\n  display: none;\n}\n.form-picture:hover::before {\n  visibility: visible;\n}\n.form-picture:hover .icon--ui_photo {\n  color: #fff;\n  visibility: visible;\n}\n.form-picture input {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0.001;\n  cursor: pointer;\n  z-index: 3;\n  overflow: hidden;\n}\n.form-picture img {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  border-radius: 5;\n}\n.form-picture__remove {\n  width: 16px;\n  height: 16px;\n  border-radius: 50%;\n  -webkit-box-shadow: 0 2px 4px 0 rgba(0,0,0,0.1);\n  box-shadow: 0 2px 4px 0 rgba(0,0,0,0.1);\n  background-color: #fff;\n  position: absolute;\n  top: -8px;\n  right: -8px;\n  z-index: 4;\n}\n.form-picture__remove::before,\n.form-picture__remove::after {\n  content: '';\n  width: 2px;\n  height: 8px;\n  background: #e14242;\n  position: absolute;\n  top: 26%;\n  left: 48%;\n}\n.form-picture__remove::after {\n  -webkit-transform: rotate(-45deg);\n  transform: rotate(-45deg);\n}\n.form-picture__remove::before {\n  -webkit-transform: rotate(45deg);\n  transform: rotate(45deg);\n}\n.form-picture--empty .form-picture__remove {\n  display: none;\n}\n.form-picture--loading .icon,\n.form-picture--loading input,\n.form-picture--loading img,\n.form-picture--loading__remove,\n.form-picture--loading::before {\n  display: none;\n}\n.form-picture--loading::after {\n  content: '';\n  position: absolute;\n  z-index: 3;\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  border: 2px solid #dedede;\n  border-top-color: $color-5;\n  left: 50%;\n  top: 50%;\n  margin-top: -10px;\n  margin-left: -10px;\n  -webkit-animation: spin 2s infinite linear;\n  animation: spin 2s infinite linear;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n.form-picture--unuploadable {\n  pointer-events: none;\n}\n@-moz-keyframes loading-bar {\n100% {\n    background-position: -56% 0;\n}\n}\n@-webkit-keyframes loading-bar {\n100% {\n    background-position: -56% 0;\n}\n}\n@-o-keyframes loading-bar {\n100% {\n    background-position: -56% 0;\n}\n}\n@keyframes loading-bar {\n100% {\n    background-position: -56% 0;\n}\n}\n@-moz-keyframes spin {\n0% {\n    transform: rotate(0deg);\n}\n100% {\n    transform: rotate(360deg);\n}\n}\n@-webkit-keyframes spin {\n0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n}\n100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n}\n}\n@-o-keyframes spin {\n0% {\n    transform: rotate(0deg);\n}\n100% {\n    transform: rotate(360deg);\n}\n}\n@keyframes spin {\n0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n}\n100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n}\n}\n.quiz-tool-input {\n  cursor: text;\n}\n.quiz-tool-input:empty:before {\n  content: attr(data-placeholder);\n  color: #bfbfbf;\n  -webkit-transition: opacity 0.2s ease;\n  transition: opacity 0.2s ease;\n}\n.quiz-tool-input:focus:before {\n  opacity: 0.4;\n}\n@media (max-width: 859px) {\n.quiz-tool-input--button {\n    margin-left: 20px;\n}\n}\n",""]),t.exports=e},1545:function(t,e,n){"use strict";n(1025)},1546:function(t,e,n){(e=n(30)(!1)).push([t.i,".quiz-tool[data-v-75df9d18] {\n  font-size: 15px;\n}\n.quiz-tool__header[data-v-75df9d18] {\n  margin-bottom: 8px;\n}\n.quiz-tool__items[data-v-75df9d18] {\n  counter-reset: quiz-option;\n}\n.quiz-tool__add[data-v-75df9d18] {\n  cursor: text;\n}\n",""]),t.exports=e},1644:function(t,e,n){"use strict";n.r(e),n.d(e,"QuizMaker",(function(){return M}));var i=n(35),o=n.n(i),r=n(42),a=n(794),s=n(18);o.a.use(r.a);const u={IS_JUST_CREATED:t=>t.is_just_created},l={ADD_ITEM(t){const e=`a${Object(s.f)()}${Object.keys(t.items).length}`;o.a.set(t.items,e,""),t.is_just_created=!1},REMOVE_ITEM(t,e){o.a.delete(t.items,e),t.is_just_created=!1},SET_PROPERTY(t,{key:e,value:n}){t[e]=n}},p={ADD_EMPTY_ITEMS({state:t,commit:e},{count:n=1}){for(let t=0;t<n;t+=1)e("ADD_ITEM");t.is_just_created=!0},REPLACE_WITH_SERVER_DATA({commit:t},e){Object.entries(e).forEach(([e,n])=>{t("SET_PROPERTY",{key:e,value:n})})},GENERATE_HASH:({state:t,commit:e},{id:n})=>new Promise(i=>{Object(a.a)().then(i=>{const o=t.date_created||Object(s.f)(),r=n?`${n}:${o}:${i}`:`tmp:${o}:${i}`;return e("SET_PROPERTY",{key:"uid",value:i}),t.date_created||e("SET_PROPERTY",{key:"date_created",value:o}),Object(a.b)(r)}).then(t=>{const o=t.substr(0,16);e("SET_PROPERTY",{key:n?"hash":"tmp_hash",value:o}),n&&e("SET_PROPERTY",{key:"tmp_hash",value:""}),i()})})};var c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"quiz-tool cdx-tool"},[n("div",{staticClass:"quiz-tool__header"},[n("quiz-title",{model:{value:t.$store.state.title,callback:function(e){t.$set(t.$store.state,"title",e)},expression:"$store.state.title"}})],1),t._v(" "),n("div",{staticClass:"quiz-tool__items"},t._l(t.items,(function(e,i){return n("quiz-item",{key:i,on:{remove:function(e){return t.removeOption(i)},submit:t.addOption},model:{value:t.items[i],callback:function(e){t.$set(t.items,i,e)},expression:"items[key]"}})})),1),t._v(" "),t.isItemsLimitReached?t._e():n("div",{staticClass:"quiz-tool-input quiz-tool-input--button",attrs:{"data-placeholder":t.addItemPlaceholder},on:{click:function(e){return t.addOption(null)}}})])};c._withStripped=!0;var d=function(){var t=this.$createElement;this._self._c;return this._m(0)};d._withStripped=!0;const m=Air.get("module.inputs");var f={name:"quiz-title",directives:{focus:{inserted:(t,e,n)=>{t.innerHTML||setTimeout(()=>{t.focus()},0)}}},props:{value:{type:String,required:!0}},data(){return{pollTitleLabel:this.$gettext("Poll title")}},mounted(){m.processVisibleIn(this.$el.parentNode)},methods:{input(t){let e=t.target.innerHTML.trim();0===t.target.textContent.trim().length&&(e=""),this.$emit("input",e)},paste(t){setTimeout(()=>{let e=t.target.innerHTML.trim();0===t.target.textContent.trim().length&&(e=""),this.$emit("input",e)},50)},keyup(t){const e=t.target;0===e.textContent.trim().length&&(e.innerHTML="")},enterPressed(t){t.preventDefault(),this.$root.callEditorApi("navigateNext")}}},h=(n(1539),n(10)),g=Object(h.a)(f,d,[function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"quiz-tool-input",attrs:{contenteditable:"true","data-placeholder":t.pollTitleLabel,maxlength:"2048"},domProps:{innerHTML:t._s(t.value)},on:{input:t.input,keyup:t.keyup,paste:t.paste,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.enterPressed.apply(null,arguments)}}})}],!1,null,"c26e9582",null);g.options.__file="src/Components/Editor/vue/quiz/quiz-title.vue";var b=g.exports,_=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"quiz-tool-item"},[this._m(0),this._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:this.itemsCount>1,expression:"itemsCount > 1"}],staticClass:"quiz-tool-item__remove",on:{click:this.remove}},[e("icon",{attrs:{name:"ui_close",width:"10",height:"10"}})],1)])};_._withStripped=!0;var x=n(26);var v={name:"quiz-item",components:{Icon:x.a},directives:{focus:{inserted:(t,e,n)=>{t.innerHTML||n.context.isJustCreated||t.focus()}}},props:{value:{type:String,required:!0}},data(){return{answerItemLabel:this.$gettext("Answer")}},computed:{isJustCreated(){return this.$store.getters.IS_JUST_CREATED},items(){return this.$store.state.items},itemsCount(){return Object.keys(this.items).length}},methods:{input(t){let e=t.target.innerHTML.trim();0===t.target.textContent.trim().length&&(e=""),this.$emit("input",e)},paste(t){setTimeout(()=>{let e=t.target.innerHTML.trim();0===t.target.textContent.trim().length&&(e=""),this.$emit("input",e)},50)},keyup(t){const e=t.target;0===e.textContent.trim().length&&(e.innerHTML="")},remove(){this.$emit("remove")},submit(t){""!==t.target.innerHTML.trim()&&this.$emit("submit",t.target)}}},y=(n(1541),Object(h.a)(v,_,[function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"quiz-tool-input",attrs:{contenteditable:"true","data-placeholder":t.answerItemLabel},domProps:{innerHTML:t._s(t.value)},on:{input:t.input,keyup:t.keyup,paste:t.paste,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),t.submit.apply(null,arguments))}}})}],!1,null,"3ed559fc",null));y.options.__file="src/Components/Editor/vue/quiz/quiz-item.vue";var k=y.exports;var w={name:"quiz",components:{QuizTitle:b,QuizItem:k},data(){return{addItemPlaceholder:this.$gettext("Add an answer")}},computed:{hash(){return this.$store.state.hash},items(){return this.$store.state.items},itemsCount(){return Object.keys(this.items).length},isItemsLimitReached(){return this.itemsCount>=30}},mounted(){if(!this.hash){const{id:t}=this.$root.getEntryData();this.$store.dispatch("GENERATE_HASH",{id:t})}0===this.itemsCount&&this.$store.dispatch("ADD_EMPTY_ITEMS",{count:2})},methods:{addOption(t){if(t){if(t.closest(".quiz-tool-item").nextElementSibling)return void this.$root.callEditorApi("navigateNext")}this.isItemsLimitReached||this.$store.commit("ADD_ITEM")},removeOption(t){this.itemsCount<=1||this.$store.commit("REMOVE_ITEM",t)}}},z=(n(1543),n(1545),Object(h.a)(w,c,[],!1,null,"75df9d18",null));z.options.__file="src/Components/Editor/vue/quiz/quiz.vue";var E=z.exports,q=n(44),T=n.n(q),$=n(55);let C=null,A=null;class M{constructor({api:t,config:e,id:n}){C=t,A=n,this.entryData=e.entry,this.quiz=null,this.container=null}makeContainer(){return this.container=document.createElement("div"),this.container}render(t){const e=function(t={}){return new r.a.Store({state:Object.assign({uid:"",hash:"",tmp_hash:"",title:"",items:{},is_public:!1,is_just_created:!1,date_created:0},t),getters:u,mutations:l,actions:p})}(t);return this.makeContainer(),o.a.use(T.a,{translations:$,defaultLanguage:window.__i18nLocale}),setTimeout(()=>{this.quiz=new o.a({el:this.container,store:e,methods:{async getData(){return await this.checkHash(),this.$store.state},checkHash(){return new Promise(t=>{const{id:e}=this.getEntryData(),{hash:n}=this.$store.state;e&&!n?this.$store.dispatch("GENERATE_HASH",{id:e}).then(t):t()})},getEntryData:()=>this.entryData,getBlockId:()=>A,callEditorApi(t,e){Array.isArray(e)?C[t](...e):C[t](e)}},render:t=>t(E)});const t=window.Air&&window.Air.get("module.hawk");t&&t.connectVue(o.a)},200),this.container}save(){return Promise.resolve().then(()=>this.quiz.getData())}}},794:function(t,e,n){"use strict";function i(){const t=new Uint32Array(1);return o(window.crypto.getRandomValues(t)[0]).then(t=>t.substring(0,16)+Date.now())}function o(t){const e=new TextEncoder("utf-8").encode(t);return window.crypto.subtle.digest("SHA-256",e).then(t=>function(t){const e=[],n=new DataView(t);for(let t=0;t<n.byteLength;t+=4){const i=n.getUint32(t).toString(16),o="00000000",r=(o+i).slice(-o.length);e.push(r)}return e.join("")}(t))}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}))}}]);