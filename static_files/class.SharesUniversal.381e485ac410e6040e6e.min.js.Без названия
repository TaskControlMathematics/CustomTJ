(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{1316:function(e,t,n){"use strict";n(931)},1317:function(e,t,n){(t=n(30)(!1)).push([e.i,'.v-shares-embed__preview {\n  --ratio: 56.25%;\n  background-color: #000;\n  position: relative;\n  margin-bottom: 16px;\n}\n.v-shares-embed__preview::before {\n  content: \'\';\n  display: block;\n  padding-top: var(--ratio);\n}\n.v-shares-embed__preview iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n.v-shares-embed__title {\n  font-size: 22px;\n  line-height: 1.3em;\n  font-weight: 500;\n  margin-bottom: 16px;\n}\n.v-shares-embed__subtitle {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n  align-items: center;\n  font-size: 16px;\n  line-height: 1.5em;\n  font-weight: 500;\n  margin-bottom: 8px;\n}\n.v-shares-embed__copy {\n  cursor: pointer;\n  color: #595959;\n  margin-left: auto;\n}\n.v-shares-embed__copy:hover {\n  color: #4683d9;\n}\n.v-shares-embed__copy .icon {\n  display: block;\n}\n.v-shares-embed__code {\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n  width: 100%;\n  resize: vertical;\n  font-family: Menlo, Consolas, "Lucida Console", Monaco, "Courier New", Courier, monospace;\n  font-size: 13px;\n  line-height: 1.4em;\n  padding: 12px 24px 12px 16px;\n  border-radius: 4px;\n  background: rgba(0,0,0,0.05);\n  border: 1px solid rgba(0,0,0,0.1);\n}\n.v-shares-embed__code:hover {\n  border-color: rgba(0,0,0,0.2);\n}\n.v-shares-embed__code:focus {\n  border-color: #4683d9;\n  outline: none;\n}\n',""]),e.exports=t},1318:function(e,t,n){"use strict";n(932)},1319:function(e,t,n){(t=n(30)(!1)).push([e.i,".v-shares--active {\n  position: relative;\n}\n.v-shares svg {\n  display: block;\n}\n.v-shares__button {\n  color: #595959;\n  cursor: pointer;\n  overflow: hidden;\n}\n@media (hover: hover) {\n.v-shares__button:hover {\n    color: #4683d9;\n}\n}\n.v-shares .popover {\n/**\n    * Increased from 2 to 10 (10 - reserve) to prevent this situation:\n    * https://cmtt-ru.atlassian.net/browse/UGC-223\n    */\n  z-index: 10;\n  margin-top: 8px;\n  left: 50%;\n  -webkit-transform: translateX(-50%);\n  transform: translateX(-50%);\n}\n",""]),e.exports=t},1654:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var i=n(35),o=n.n(i),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.onClickOutside,expression:"onClickOutside"}],ref:"container",class:["v-shares",{"v-shares--active":e.isPopoverActive}],attrs:{title:e.$gettext("Share")}},[n("div",{staticClass:"v-shares__button",on:{click:e.onToggleClick}},[n("icon",{attrs:{name:"v_share",width:"24",height:"24"}})],1),e._v(" "),e.isPopoverActive?n("popover",{model:{value:e.popoverItems,callback:function(t){e.popoverItems=t},expression:"popoverItems"}}):e._e()],1)};s._withStripped=!0;var a=n(567),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"v-shares-embed"},[n("div",{staticClass:"v-shares-embed__title"},[n("translate",{attrs:{"translate-context":"Share"}},[e._v("\n      Embed\n    ")])],1),e._v(" "),n("div",{staticClass:"v-shares-embed__preview",style:{"--ratio":100*e.previewRatio+"%"},domProps:{innerHTML:e._s(e.value)}}),e._v(" "),n("div",{staticClass:"v-shares-embed__subtitle"},[n("translate",[e._v("\n      Embed code\n    ")]),e._v(" "),n("div",{staticClass:"v-shares-embed__copy",on:{click:e.copyCode}},[n("icon",{attrs:{name:"v_copy",width:"24",height:"24"}})],1)],1),e._v(" "),n("textarea",{ref:"code",staticClass:"v-shares-embed__code",attrs:{readonly:""},domProps:{value:e.value},on:{focus:e.onCodeFocus}})])};r._withStripped=!0;var l=n(26),c=n(158),p=n(5),m={name:"layout-shares",components:{Icon:l.a},props:{value:{type:String,required:!0}},computed:{previewRatio(){const e=parseInt(/width="(\d+)"/gi.exec(this.value)[1],10),t=parseInt(/height="(\d+)"/gi.exec(this.value)[1],10);return e&&t?parseFloat((t/e).toFixed(4)):56.25}},mounted(){const{code:e}=this.$refs;e.style.height="1px",e.style.height=e.scrollHeight+2+"px"},methods:{async copyCode(){await Object(c.a)(this.value),Object(p.success)(this.$gettext("The embed code has been copied"))},onCodeFocus(e){e.target.select()}}},d=(n(1316),n(10)),h=Object(d.a)(m,r,[],!1,null,null,null);h.options.__file="src/Components/Shares/vue/layout-shares-embed.vue";var u=h.exports,v=n(89),f=n(20),_=n(17),b={name:"layout-shares",components:{Icon:l.a,Popover:v.default},data:()=>({isPopoverActive:!1,moduleShares:null,appCodename:window.__codename}),computed:{params(){return this.$root.params},copyButtonParams(){return{title:this.$gettext("Copy the link"),icon:"v_link",action:()=>{Object(c.a)(this.params.url).then(()=>{Object(p.success)(this.$gettext("The link has been copied")),this.isPopoverActive=!1,this.$popup.close()})}}},favoriteButtonParams(){return{title:this.params.isFavorited?this.$gettext("Remove from bookmarks"):this.$gettext("Add to bookmarks"),icon:this.params.isFavorited?"v_favorite_solid":"v_favorite",action:()=>{this.params.isFavorited=!this.params.isFavorited,this.$root.setFavoriteState(this.params.isFavorited),this.$popup.close()}}},embedButtonParams(){return{title:this.$pgettext("Share","Embed"),icon:"v_code",action:()=>{this.$popup.open(u,{maxWidth:680,props:{value:this.params.embed}}),this.isPopoverActive=!1}}},systemButtonParams(){return{title:this.$gettext("Share via..."),icon:"v_share",action:()=>{window.navigator.share({title:this.params.title,url:this.params.url}),this.$popup.close()}}},servicesPopoverItems(){const e={},t=Object.keys(this.params.services);return this.moduleShares.orderServicesByHistory(t).forEach(t=>{const{title:n,url:i}=this.params.services[t],o="v_"+t;e[t]={title:n,icon:o,action:()=>{this.openWindow(i),this.moduleShares.updateHistory(t)}}}),e},popoverItems(){const e=Object.values({copy:this.copyButtonParams,favorite:this.favoriteButtonParams,...this.servicesPopoverItems});return this.params.embed&&(e.embed=this.embedButtonParams),e.forEach(e=>{e.label=e.title}),e},mobilePopoverItems(){const e={copy:this.copyButtonParams,favorite:this.favoriteButtonParams},t=[e],n="function"==typeof window.navigator.share;return this.params.embed&&(e.embed=this.embedButtonParams),n&&t.push({system:this.systemButtonParams}),t}},created(){this.moduleShares=Air.import("module.shares")},mounted(){this.$root.$on("openShareDialog",this.onToggleClick)},beforeDestroy(){this.$root.$off()},methods:{onToggleClick(){f.e.is("mobile")?this.$popup.open(a.a,{align:"bottom",theme:"gray",props:{title:"Share",items:this.mobilePopoverItems}}):this.isPopoverActive=!this.isPopoverActive},onClickOutside(){this.isPopoverActive=!1},openWindow(e){const t=(Object(_.f)()-600)/2,n=(Object(_.e)()-450)/2;window.open(e,"_blank",`toolbar=yes,scrollbars=yes,resizable=yes,width=600,height=450,left=${t},top=${n}`)}}},g=(n(1318),Object(d.a)(b,s,[],!1,null,null,null));g.options.__file="src/Components/Shares/vue/layout-shares.vue";var x=g.exports,y=n(123),w=n(566),k=n(44),C=n.n(k),$=n(55),P=n(0);class S{constructor({element:e}){this.wrapper=e,this.container=null,this.moduleFavoriteModel=null,this.params=null,this.app=null,this.prepareParams(),this.prepareContainer(),this.init()}prepareParams(){const e=Object(P.data)(this.wrapper,"data");try{const t=e?JSON.parse(e):{};this.params=t}catch(e){console.error("SharesUniversal params prepare:",e)}}prepareContainer(){this.container=document.createElement("div"),this.wrapper.appendChild(this.container)}init(){o.a.use(C.a,{translations:$,defaultLanguage:window.__i18nLocale}),o.a.directive("click-outside",y.a),o.a.use(w.a),this.app=new o.a({el:this.container,data:{params:this.params},methods:{setFavoriteState:e=>{this.moduleFavoriteModel.setState({id:this.params.id,type:1,state:e})}},render:e=>e(x)}),this.moduleFavoriteModel=Air.import("module.favorite_model"),this.moduleFavoriteModel.on("Updated "+this.params.id,e=>{this.params.isFavorited=e.state});const e=window.Air&&window.Air.get("module.hawk");e&&e.connectVue(o.a)}destroy(){this.moduleFavoriteModel&&(this.moduleFavoriteModel.off(),this.moduleFavoriteModel=null),this.app.$popup&&this.app.$popup.close(),this.app&&(this.app.$destroy(),this.app=null),this.params=null,this.wrapper=null,this.container=null}openShareDialog(){this.app.$emit("openShareDialog")}}},567:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"v-mobile-menu"},[n("div",{staticClass:"v-mobile-menu__header"},[e.title?n("div",{staticClass:"v-mobile-menu__name"},[e._v("\n      "+e._s(e.title)+"\n    ")]):e._e(),e._v(" "),n("div",{staticClass:"v-mobile-menu__close",on:{click:function(t){return e.$emit("close")}}},[n("icon",{attrs:{name:"v_close",width:"16",height:"16"}})],1)]),e._v(" "),e._l(e.filteredItems,(function(t,i){return n("div",{key:i,staticClass:"v-mobile-menu__list"},e._l(t,(function(t,i){return n(t.url?"a":"div",{key:i,tag:"component",staticClass:"v-mobile-menu__item",attrs:{href:t.url||!1,target:!!t.url&&"_blank"},on:{click:function(e){"function"==typeof t.action&&t.action()}}},[n("div",{staticClass:"v-mobile-menu__icon"},[t.icon?n("icon",{attrs:{name:t.icon,width:"24",height:"24"}}):e._e()],1),e._v(" "),n("div",{staticClass:"v-mobile-menu__title"},[n("span",[e._v(e._s(t.title))])]),e._v(" "),t.more?n("div",{staticClass:"v-mobile-menu__more"},[n("icon",{attrs:{name:"v_arrow_right",width:"20",height:"20"}})],1):e._e()])})),1)})),e._v(" "),e._t("default")],2)};i._withStripped=!0;var o={name:"layout-mobile-menu",components:{Icon:n(26).a},props:{title:{type:String,default:""},items:{type:Object,default:()=>[]}},computed:{filteredItems(){return this.items.filter(e=>Object.keys(e).length)}}},s=(n(627),n(10)),a=Object(s.a)(o,i,[],!1,null,null,null);a.options.__file="src/Components/Ui/vue/layout/layout-mobile-menu.vue";t.a=a.exports},585:function(e,t,n){var i=n(628);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n(31).default)("3062bb32",i,!1,{})},627:function(e,t,n){"use strict";n(585)},628:function(e,t,n){(t=n(30)(!1)).push([e.i,".v-mobile-menu {\n  --offset-x: 20px;\n  --offset-y: 20px;\n  --height: 48px;\n  --font-size: 16px;\n  padding: 0 var(--offset-x) var(--offset-y);\n}\n.v-mobile-menu__header {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n  align-items: center;\n  line-height: 1.5em;\n  font-weight: 500;\n  padding: 0 var(--offset-x);\n  margin-left: calc(var(--offset-x) * -1);\n  margin-right: calc(var(--offset-x) * -1);\n  height: 50px;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n  position: -webkit-sticky;\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background-color: #fff;\n  margin-bottom: 2px;\n}\n.v-mobile-menu__name {\n  margin-top: 5px;\n}\n.v-mobile-menu__close {\n  margin-left: auto;\n  -ms-flex-item-align: start;\n  align-self: flex-start;\n  padding: 10px;\n  margin-right: calc(var(--offset-x) * -1);\n  cursor: pointer;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n  align-items: center;\n}\n.v-mobile-menu__close .icon {\n  display: block;\n}\n.v-mobile-menu__list:not(:last-child):after {\n  content: '';\n  display: block;\n  height: 1px;\n  background-color: rgba(0,0,0,0.1);\n  margin: 8px 0;\n  margin-left: 36px;\n  margin-right: calc(var(--offset-x) * -1);\n}\n.v-mobile-menu__list:last-child {\n  margin-bottom: -12px;\n}\n.v-mobile-menu__item {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n  align-items: center;\n  font-size: var(--font-size);\n  line-height: var(--height);\n  cursor: pointer;\n  white-space: nowrap;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.v-mobile-menu__icon {\n  width: 24px;\n  height: 24px;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n  align-items: center;\n  -ms-flex-pack: center;\n  justify-content: center;\n  margin-right: 12px;\n  color: #000;\n}\n.v-mobile-menu__icon .icon--v_favorite_solid {\n  fill: #4683d9;\n}\n.v-mobile-menu__title {\n  min-width: 0;\n  -ms-flex: 1;\n  flex: 1;\n}\n.v-mobile-menu__title span {\n  display: block;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.v-mobile-menu__more .icon {\n  display: block;\n}\n",""]),e.exports=t},931:function(e,t,n){var i=n(1317);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n(31).default)("48ff03ee",i,!1,{})},932:function(e,t,n){var i=n(1319);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n(31).default)("5d12891e",i,!1,{})}}]);